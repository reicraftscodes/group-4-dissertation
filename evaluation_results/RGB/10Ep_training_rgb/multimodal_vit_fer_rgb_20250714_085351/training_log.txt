2025-07-14 08:53:57,537 - INFO - Class weights: tensor([0.7573, 2.6338, 1.6954, 0.4904, 5.9426, 0.6704, 0.9892],
       device='cuda:0')
2025-07-14 08:53:57,826 - INFO - Trainer initialized. Experiment: multimodal_vit_fer_rgb_20250714_085351
2025-07-14 08:53:57,827 - INFO - Save directory: ./experiments/multimodal_vit_fer_rgb_20250714_085351
2025-07-14 08:53:57,828 - INFO - Training mode: rgb
2025-07-14 08:53:57,830 - INFO - Training samples: 16,556
2025-07-14 08:53:57,834 - INFO - Test samples: 4,139
2025-07-14 08:53:57,835 - INFO - Use augmented data: True
2025-07-14 08:53:57,835 - INFO - Training configuration: {
  "data_dir": "Data",
  "output_dir": "./experiments",
  "mode": "rgb",
  "fusion_strategy": "early",
  "fusion_type": "concat",
  "fusion_layer": "feature",
  "model_name": "google/vit-base-patch16-224-in21k",
  "num_classes": 7,
  "dropout_rate": 0.1,
  "freeze_backbone": false,
  "use_gradient_checkpointing": false,
  "batch_size": 32,
  "num_epochs": 10,
  "learning_rate": 5e-05,
  "weight_decay": 0.01,
  "warmup_steps": 500,
  "gradient_clip_norm": 1.0,
  "image_size": 224,
  "num_workers": 4,
  "val_split": 0.2,
  "use_augmented": true,
  "use_class_weights": true,
  "early_stopping_patience": 10,
  "early_stopping_min_delta": 0.001,
  "use_wandb": false,
  "wandb_project": "multimodal-fer"
}
2025-07-14 08:53:57,837 - INFO - Starting training for 10 epochs
2025-07-14 08:53:57,838 - INFO - 
=== Epoch 1/10 ===
2025-07-14 09:55:48,952 - INFO - Train - Loss: 1.6965, Acc: 0.3483, F1: 0.3423, Precision: 0.3530, Recall: 0.3483
2025-07-14 09:55:48,953 - INFO - Val   - Loss: 1.1069, Acc: 0.5612, F1: 0.5441, Precision: 0.5780, Recall: 0.5612
2025-07-14 09:55:54,416 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 09:55:54,417 - INFO - New best model saved with F1: 0.5441
2025-07-14 09:55:54,419 - INFO - 
=== Epoch 2/10 ===
2025-07-14 10:05:25,641 - INFO - Train - Loss: 0.9256, Acc: 0.6440, F1: 0.6392, Precision: 0.6466, Recall: 0.6440
2025-07-14 10:05:25,642 - INFO - Val   - Loss: 0.6931, Acc: 0.7403, F1: 0.7359, Precision: 0.7497, Recall: 0.7403
2025-07-14 10:05:32,684 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 10:05:32,686 - INFO - New best model saved with F1: 0.7359
2025-07-14 10:05:32,687 - INFO - 
=== Epoch 3/10 ===
2025-07-14 10:15:22,477 - INFO - Train - Loss: 0.6523, Acc: 0.7529, F1: 0.7510, Precision: 0.7535, Recall: 0.7529
2025-07-14 10:15:22,478 - INFO - Val   - Loss: 0.5108, Acc: 0.8231, F1: 0.8205, Precision: 0.8265, Recall: 0.8231
2025-07-14 10:15:29,899 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 10:15:29,901 - INFO - New best model saved with F1: 0.8205
2025-07-14 10:15:29,902 - INFO - 
=== Epoch 4/10 ===
2025-07-14 10:25:19,547 - INFO - Train - Loss: 0.5027, Acc: 0.8136, F1: 0.8129, Precision: 0.8138, Recall: 0.8136
2025-07-14 10:25:19,548 - INFO - Val   - Loss: 0.4233, Acc: 0.8524, F1: 0.8499, Precision: 0.8554, Recall: 0.8524
2025-07-14 10:25:23,954 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 10:25:23,956 - INFO - New best model saved with F1: 0.8499
2025-07-14 10:25:23,958 - INFO - 
=== Epoch 5/10 ===
2025-07-14 10:35:14,271 - INFO - Train - Loss: 0.4115, Acc: 0.8500, F1: 0.8494, Precision: 0.8502, Recall: 0.8500
2025-07-14 10:35:14,273 - INFO - Val   - Loss: 0.3366, Acc: 0.8840, F1: 0.8829, Precision: 0.8867, Recall: 0.8840
2025-07-14 10:35:19,974 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 10:35:19,976 - INFO - New best model saved with F1: 0.8829
2025-07-14 10:35:19,978 - INFO - 
=== Epoch 6/10 ===
2025-07-14 10:45:08,735 - INFO - Train - Loss: 0.3549, Acc: 0.8709, F1: 0.8704, Precision: 0.8713, Recall: 0.8709
2025-07-14 10:45:08,736 - INFO - Val   - Loss: 0.2950, Acc: 0.8980, F1: 0.8961, Precision: 0.9004, Recall: 0.8980
2025-07-14 10:45:14,555 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 10:45:14,560 - INFO - New best model saved with F1: 0.8961
2025-07-14 10:45:14,562 - INFO - 
=== Epoch 7/10 ===
2025-07-14 10:55:04,064 - INFO - Train - Loss: 0.3157, Acc: 0.8861, F1: 0.8856, Precision: 0.8862, Recall: 0.8861
2025-07-14 10:55:04,065 - INFO - Val   - Loss: 0.2863, Acc: 0.9031, F1: 0.9017, Precision: 0.9050, Recall: 0.9031
2025-07-14 10:55:09,795 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 10:55:09,797 - INFO - New best model saved with F1: 0.9017
2025-07-14 10:55:09,798 - INFO - 
=== Epoch 8/10 ===
2025-07-14 11:05:00,788 - INFO - Train - Loss: 0.2932, Acc: 0.8948, F1: 0.8944, Precision: 0.8948, Recall: 0.8948
2025-07-14 11:05:00,789 - INFO - Val   - Loss: 0.2703, Acc: 0.9087, F1: 0.9073, Precision: 0.9101, Recall: 0.9087
2025-07-14 11:05:09,013 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 11:05:09,015 - INFO - New best model saved with F1: 0.9073
2025-07-14 11:05:09,017 - INFO - 
=== Epoch 9/10 ===
2025-07-14 11:15:00,264 - INFO - Train - Loss: 0.2789, Acc: 0.9012, F1: 0.9009, Precision: 0.9013, Recall: 0.9012
2025-07-14 11:15:00,265 - INFO - Val   - Loss: 0.2590, Acc: 0.9142, F1: 0.9133, Precision: 0.9150, Recall: 0.9142
2025-07-14 11:15:06,209 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 11:15:06,223 - INFO - New best model saved with F1: 0.9133
2025-07-14 11:15:06,225 - INFO - 
=== Epoch 10/10 ===
2025-07-14 11:24:56,061 - INFO - Train - Loss: 0.2790, Acc: 0.8990, F1: 0.8986, Precision: 0.8991, Recall: 0.8990
2025-07-14 11:24:56,062 - INFO - Val   - Loss: 0.2567, Acc: 0.9152, F1: 0.9142, Precision: 0.9161, Recall: 0.9152
2025-07-14 11:25:01,844 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/best_model.pth
2025-07-14 11:25:01,848 - INFO - New best model saved with F1: 0.9142
2025-07-14 11:25:06,962 - INFO - Checkpoint saved: ./experiments/multimodal_vit_fer_rgb_20250714_085351/last_model.pth
2025-07-14 11:25:11,695 - INFO - === DETAILED EVALUATION RESULTS ===
2025-07-14 11:25:11,696 - INFO - Overall Accuracy: 0.9152
2025-07-14 11:25:11,698 - INFO - Macro F1-Score: 0.8929
2025-07-14 11:25:11,699 - INFO - Micro F1-Score: 0.9152
2025-07-14 11:25:11,700 - INFO - Weighted F1-Score: 0.9142
2025-07-14 11:25:11,701 - INFO - Per-class Accuracy:
2025-07-14 11:25:11,702 - INFO -   angry: 0.9459
2025-07-14 11:25:11,702 - INFO -   disgust: 0.7729
2025-07-14 11:25:11,703 - INFO -   fear: 0.8866
2025-07-14 11:25:11,704 - INFO -   happy: 0.9196
2025-07-14 11:25:11,705 - INFO -   neutral: 0.7009
2025-07-14 11:25:11,706 - INFO -   sad: 0.9775
2025-07-14 11:25:11,707 - INFO -   surprised: 0.8818
2025-07-14 11:25:11,708 - INFO - Final evaluation completed with comprehensive metrics
2025-07-14 11:25:11,725 - INFO - Training completed!
